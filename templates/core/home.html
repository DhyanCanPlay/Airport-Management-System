{% extends 'base.html' %}
{% load static %}

{% block title %}Airport Management System - Multi-Portal Platform{% endblock %}

{% block content %}
<div class="hero-section bg-primary text-white py-5 mb-4">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold mb-3">‚úàÔ∏è Professional Airport Management System</h1>
                <p class="lead mb-4">A complete multi-portal platform featuring Customer, Airline Operations, Crew, and Administration portals - designed for modern airport management.</p>
                
                {% if user.is_authenticated %}
                    <div class="alert alert-light">
                        <strong>Welcome back, {{ user.get_full_name|default:user.username }}!</strong>
                        <p class="mb-0">You're being redirected to your portal...</p>
                    </div>
                {% else %}
                    <div class="d-flex gap-2 flex-wrap">
                        <a href="{% url 'login' %}" class="btn btn-light btn-lg">
                            <i class="fas fa-sign-in-alt"></i> Login to Portal
                        </a>
                        <a href="{% url 'register' %}" class="btn btn-outline-light btn-lg">
                            <i class="fas fa-user-plus"></i> Register Account
                        </a>
                    </div>
                {% endif %}
            </div>
            <div class="col-lg-4 text-center">
                <div class="bg-white text-dark rounded p-4 shadow">
                    <h5 class="fw-bold mb-3">Live Flight Information</h5>
                    <div class="row text-center">
                        <div class="col-4">
                            <h3 class="text-primary">{{ total_flights }}</h3>
                            <small>Total Flights</small>
                        </div>
                        <div class="col-4">
                            <h3 class="text-success">{{ total_bookings }}</h3>
                            <small>Active Bookings</small>
                        </div>
                        <div class="col-4">
                            <h3 class="text-info">{{ total_passengers }}</h3>
                            <small>Registered Passengers</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% if show_portal_links %}
<!-- Multi-Portal Access Section -->
<div class="container mb-5">
    <div class="text-center mb-5">
        <h2 class="fw-bold">Access Your Portal</h2>
        <p class="text-muted">Choose the portal that matches your role in the airport ecosystem</p>
    </div>
    
    <div class="row g-4">
        <!-- Customer Portal -->
        <div class="col-lg-3 col-md-6">
            <div class="card h-100 shadow-sm border-0 portal-card">
                <div class="card-body text-center p-4">
                    <div class="portal-icon mb-3">
                        <i class="fas fa-user-friends fa-3x text-primary"></i>
                    </div>
                    <h5 class="card-title fw-bold">Customer Portal</h5>
                    <p class="card-text text-muted">Book flights, manage bookings, online check-in, and track your loyalty status.</p>
                    <ul class="list-unstyled text-start small mb-4">
                        <li><i class="fas fa-check text-success"></i> Flight Search & Booking</li>
                        <li><i class="fas fa-check text-success"></i> Online Check-in</li>
                        <li><i class="fas fa-check text-success"></i> Boarding Pass Download</li>
                        <li><i class="fas fa-check text-success"></i> Loyalty Program</li>
                        <li><i class="fas fa-check text-success"></i> Live Flight Status</li>
                    </ul>
                    <a href="/customer/" class="btn btn-primary btn-sm">
                        <i class="fas fa-arrow-right"></i> Access Portal
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Airline Operations Portal -->
        <div class="col-lg-3 col-md-6">
            <div class="card h-100 shadow-sm border-0 portal-card">
                <div class="card-body text-center p-4">
                    <div class="portal-icon mb-3">
                        <i class="fas fa-plane-departure fa-3x text-success"></i>
                    </div>
                    <h5 class="card-title fw-bold">Airline Operations</h5>
                    <p class="card-text text-muted">Operations command center for flight scheduling, gate management, and passenger assistance.</p>
                    <ul class="list-unstyled text-start small mb-4">
                        <li><i class="fas fa-check text-success"></i> Operations Dashboard</li>
                        <li><i class="fas fa-check text-success"></i> Flight Scheduling</li>
                        <li><i class="fas fa-check text-success"></i> Gate Management</li>
                        <li><i class="fas fa-check text-success"></i> Passenger Assistance</li>
                        <li><i class="fas fa-check text-success"></i> Analytics & Reports</li>
                    </ul>
                    <a href="/airline/" class="btn btn-success btn-sm">
                        <i class="fas fa-arrow-right"></i> Access Portal
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Crew Portal -->
        <div class="col-lg-3 col-md-6">
            <div class="card h-100 shadow-sm border-0 portal-card">
                <div class="card-body text-center p-4">
                    <div class="portal-icon mb-3">
                        <i class="fas fa-users fa-3x text-warning"></i>
                    </div>
                    <h5 class="card-title fw-bold">Crew Portal</h5>
                    <p class="card-text text-muted">Crew management system for pilots and cabin crew to manage schedules and reports.</p>
                    <ul class="list-unstyled text-start small mb-4">
                        <li><i class="fas fa-check text-success"></i> Personal Roster</li>
                        <li><i class="fas fa-check text-success"></i> Flight Briefings</li>
                        <li><i class="fas fa-check text-success"></i> Schedule Bidding</li>
                        <li><i class="fas fa-check text-success"></i> Qualifications Tracker</li>
                        <li><i class="fas fa-check text-success"></i> Post-Flight Reports</li>
                    </ul>
                    <a href="/crew/" class="btn btn-warning btn-sm">
                        <i class="fas fa-arrow-right"></i> Access Portal
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Admin Portal -->
        <div class="col-lg-3 col-md-6">
            <div class="card h-100 shadow-sm border-0 portal-card">
                <div class="card-body text-center p-4">
                    <div class="portal-icon mb-3">
                        <i class="fas fa-cogs fa-3x text-danger"></i>
                    </div>
                    <h5 class="card-title fw-bold">System Admin</h5>
                    <p class="card-text text-muted">Complete system administration with user management and system monitoring.</p>
                    <ul class="list-unstyled text-start small mb-4">
                        <li><i class="fas fa-check text-success"></i> User Management</li>
                        <li><i class="fas fa-check text-success"></i> System Configuration</li>
                        <li><i class="fas fa-check text-success"></i> Integration Monitor</li>
                        <li><i class="fas fa-check text-success"></i> Audit Logs</li>
                        <li><i class="fas fa-check text-success"></i> Database Management</li>
                    </ul>
                    <a href="/admin-portal/" class="btn btn-danger btn-sm">
                        <i class="fas fa-arrow-right"></i> Access Portal
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Live Departures Section -->
<div class="container">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold">üõ´ Live Departures</h3>
                <a href="{% url 'flight_list' %}" class="btn btn-outline-primary">View All Flights</a>
            </div>
            
            {% if departing_soon %}
            <div class="card shadow-sm">
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th>Flight</th>
                                    <th>Route</th>
                                    <th>Departure</th>
                                    <th>Gate</th>
                                    <th>Status</th>
                                    <th>Available Seats</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for flight in departing_soon %}
                                <tr>
                                    <td>
                                        <strong>{{ flight.flight_number }}</strong><br>
                                        <small class="text-muted">{{ flight.airline }}</small>
                                    </td>
                                    <td>
                                        <span class="badge bg-light text-dark">{{ flight.departure_city }}</span>
                                        <i class="fas fa-arrow-right mx-1"></i>
                                        <span class="badge bg-light text-dark">{{ flight.arrival_city }}</span>
                                    </td>
                                    <td>
                                        <strong>{{ flight.departure_time|date:"H:i" }}</strong><br>
                                        <small class="text-muted">{{ flight.departure_time|date:"M d" }}</small>
                                    </td>
                                    <td>
                                        <span class="badge bg-info">{{ flight.gate_number|default:"TBD" }}</span>
                                    </td>
                                    <td>
                                        {% if flight.status == 'scheduled' %}
                                            <span class="badge bg-success">On Time</span>
                                        {% elif flight.status == 'delayed' %}
                                            <span class="badge bg-warning">Delayed</span>
                                        {% elif flight.status == 'boarding' %}
                                            <span class="badge bg-primary">Boarding</span>
                                        {% else %}
                                            <span class="badge bg-secondary">{{ flight.get_status_display }}</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <strong class="text-primary">{{ flight.available_seats }}</strong>
                                        <small class="text-muted">/ {{ flight.total_seats }}</small>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="text-center py-5">
                <i class="fas fa-plane fa-3x text-muted mb-3"></i>
                <h5 class="text-muted">No departures scheduled for the next 4 hours</h5>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
.hero-section {
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
}

.portal-card {
    transition: transform 0.2s, box-shadow 0.2s;
}

.portal-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
}

.portal-icon {
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.table-hover tbody tr:hover {
    background-color: rgba(0, 123, 255, 0.05);
}
</style>
{% endblock %}
